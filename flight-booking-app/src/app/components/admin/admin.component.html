<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<app-navbar [hideButtons]="hideNavbarButtons" [showLogoutButton]="true"></app-navbar>
<div class="container my-5">
  <h2 class="text-center mb-4">Flight Management</h2>

  <div *ngIf="isEditing" class="card p-4 shadow-sm">
    <h3 class="text-primary mb-4">Edit Flight</h3>
    <form (ngSubmit)="updateFlight()">
      <div class="form-group">
        <label>Flight Number: {{ selectedFlight.flightNumber }}</label>
      </div>
      <div class="form-group">
        <label for="flightName">Flight Name:</label>
        <input type="text" class="form-control" [(ngModel)]="selectedFlight.flightName" name="flightName">
      </div>
      <div class="form-group">
        <label for="source">Source:</label>
        <input type="text" class="form-control" [(ngModel)]="selectedFlight.source" name="source">
      </div>
      <div class="form-group">
        <label for="destination">Destination:</label>
        <input type="text" class="form-control" [(ngModel)]="selectedFlight.destination" name="destination">
      </div>
      <div class="form-group">
        <label for="departureDate">Departure Date:</label>
        <input type="date" class="form-control" [(ngModel)]="selectedFlight.departureDate" name="departureDate">
      </div>
      <div class="form-group">
        <label for="departureTime">Departure Time:</label>
        <input type="time" class="form-control" [(ngModel)]="selectedFlight.departureTime" name="departureTime">
      </div>
      <div class="form-group">
        <label for="arrivalDate">Arrival Date:</label>
        <input type="date" class="form-control" [(ngModel)]="selectedFlight.arrivalDate" name="arrivalDate">
      </div>
      <div class="form-group">
        <label for="arrivalTime">Arrival Time:</label>
        <input type="time" class="form-control" [(ngModel)]="selectedFlight.arrivalTime" name="arrivalTime">
      </div>
      <div class="form-group">
        <label for="fare">Fare:</label>
        <input type="number" class="form-control" [(ngModel)]="selectedFlight.fare" name="fare">
      </div>
      <button type="submit" class="btn btn-primary">Save</button>
      <button type="button" class="btn btn-secondary ml-2" (click)="cancelEdit()">Cancel</button>
    </form>
  </div>

  <div *ngIf="!isEditing" class="card p-4 shadow-sm mt-5">
    <h3 class="text-success mb-4">Add New Flight</h3>
    <form (ngSubmit)="addFlight()">
      <div class="form-group">
        <label for="flightNumber">Flight Number:</label>
        <input type="text" class="form-control" [(ngModel)]="newFlight.flightNumber" name="flightNumber">
      </div>
      <div class="form-group">
        <label for="flightName">Flight Name:</label>
        <input type="text" class="form-control" [(ngModel)]="newFlight.flightName" name="flightName">
      </div>
      <div class="form-group">
        <label for="source">Source:</label>
        <input type="text" class="form-control" [(ngModel)]="newFlight.source" name="source">
      </div>
      <div class="form-group">
        <label for="destination">Destination:</label>
        <input type="text" class="form-control" [(ngModel)]="newFlight.destination" name="destination">
      </div>
      <div class="form-group">
        <label for="departureDate">Departure Date:</label>
        <input type="date" class="form-control" [(ngModel)]="newFlight.departureDate" name="departureDate">
      </div>
      <div class="form-group">
        <label for="departureTime">Departure Time:</label>
        <input type="time" class="form-control" [(ngModel)]="newFlight.departureTime" name="departureTime">
      </div>
      <div class="form-group">
        <label for="arrivalDate">Arrival Date:</label>
        <input type="date" class="form-control" [(ngModel)]="newFlight.arrivalDate" name="arrivalDate">
      </div>
      <div class="form-group">
        <label for="arrivalTime">Arrival Time:</label>
        <input type="time" class="form-control" [(ngModel)]="newFlight.arrivalTime" name="arrivalTime">
      </div>
      <div class="form-group">
        <label for="fare">Fare:</label>
        <input type="number" class="form-control" [(ngModel)]="newFlight.fare" name="fare">
      </div>
      <button type="submit" class="btn btn-success">Add Flight</button>
    </form>
  </div>

  <h3 class="text-center mt-5">Flights List</h3>
  <div class="table-responsive">
    <table class="table table-striped table-bordered mt-3">
      <thead class="thead-dark">
        <tr>
          <th>Flight Number</th>
          <th>Flight Name</th>
          <th>Source</th>
          <th>Destination</th>
          <th>Departure</th>
          <th>Arrival</th>
          <th>Fare</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let flight of flights">
          <td>{{ flight.flightNumber }}</td>
          <td>{{ flight.flightName }}</td>
          <td>{{ flight.source }}</td>
          <td>{{ flight.destination }}</td>
          <td>{{ flight.departureDate | date:'shortDate' }} {{ flight.departureTime }}</td>
          <td>{{ flight.arrivalDate | date:'shortDate' }} {{ flight.arrivalTime }}</td>
          <td>{{ flight.fare | currency:'INR' }}</td>
          <td>
            <button class="btn btn-warning btn-sm" (click)="editFlight(flight)">Edit</button>
            <button class="btn btn-danger btn-sm" (click)="deleteFlight(flight.flightNumber)">Delete</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
